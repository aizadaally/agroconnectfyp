<!-- frontend/templates/frontend/home.html -->
{% extends 'frontend/base.html' %}
{% load i18n %}
{% load static %}

{% block title %}{% trans "AgroConnect Naryn - Farm to Table Marketplace" %}{% endblock %}


{% block extra_css %}
<style>
    /* Hero statistics - ensure visibility */
    .hero-stat-number {
        font-size: 3.5rem !important;
        font-weight: 800 !important;
        color: #22C55E !important;
        text-shadow: 3px 3px 8px rgba(0, 0, 0, 1) !important;
        display: block !important;
        line-height: 1 !important;
    }
    
    .hero-stat-label {
        font-size: 1.2rem !important;
        font-weight: 700 !important;
        color: #FFFFFF !important;
        text-shadow: 2px 2px 6px rgba(0, 0, 0, 1) !important;
        text-transform: uppercase !important;
        letter-spacing: 2px !important;
        margin-top: 0.5rem !important;
    }
    
    .stats-container {
        background: rgba(0, 0, 0, 0.75) !important;
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
    }
    
    /* Keep your existing map styles if they exist */
    .map-responsive {
        position: relative;
        padding-bottom: 56.25%;
        height: 0;
        overflow: hidden;
        max-width: 100%;
    }
    
    .map-responsive iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
    }
    
    @media (max-width: 768px) {
        .map-responsive {
            padding-bottom: 75%;
        }
    }
</style>
{% endblock %}

{% block content %}
<!-- Hero Section with Naryn Mountains -->
<div class="hero-section">
    <!-- Floating particles effect -->
    <div class="floating-particles" id="particles-container"></div>
    
    <div class="container">
        <div class="hero-content">
            <h1 class="hero-title animate__animated animate__fadeInUp">
                {% trans "Fresh From Naryn's Majestic Mountains" %}
            </h1>
            <p class="hero-subtitle animate__animated animate__fadeInUp animate__delay-1s">
                {% trans "Connecting Naryn's local farmers directly with you" %}
                <span class="naryn-badge">{% trans "Since 2025" %}</span>
            </p>
            
            <!-- Statistics Container -->
            <div class="stats-container animate__animated animate__fadeInUp animate__delay-2s">
                <div class="row">
                    <div class="col-md-3 stat-item">
                        <span class="stat-number">{{ total_farmers|default:"150+" }}</span>
                        <span class="stat-label">{% trans "Active Farmers" %}</span>
                    </div>
                    <div class="col-md-3 stat-item">
                        <span class="stat-number">{{ total_products|default:"500+" }}</span>
                        <span class="stat-label">{% trans "Fresh Products" %}</span>
                    </div>
                    <div class="col-md-3 stat-item">
                        <span class="stat-number">{{ total_districts|default:"5" }}</span>
                        <span class="stat-label">{% trans "Naryn Districts" %}</span>
                    </div>
                    <div class="col-md-3 stat-item">
                        <span class="stat-number">98%</span>
                        <span class="stat-label">{% trans "Customer Satisfaction" %}</span>
                    </div>
                </div>
            </div>
            
            <!-- Action Buttons -->
            <div class="hero-buttons mt-4 animate__animated animate__fadeInUp animate__delay-3s">
                <a href="{% url 'frontend:products' %}" class="btn btn-success btn-lg me-3">
                    <i class="bi bi-basket me-2"></i>{% trans "Shop Now" %}
                </a>
                {% if not user.is_authenticated %}
                <a href="{% url 'frontend:register' %}?user_type=FARMER" class="btn btn-outline-light btn-lg">
                    <i class="bi bi-plus-circle me-2"></i>{% trans "Join as Farmer" %}
                </a>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- Update the Naryn Districts Section in frontend/templates/frontend/home.html -->
<!-- Replace the existing district section with this one -->

<!-- Naryn Districts Section -->
<section class="naryn-districts-section py-5">
    <div class="container">
        <div class="section-header text-center mb-5">
            <h2>{% trans "Explore Naryn's Agricultural Districts" %}</h2>
            <p class="lead">{% trans "Fresh produce from every corner of our beautiful region" %}</p>
        </div>
        
        <div class="row g-4">
            <div class="col-md-4">
                <div class="district-card">
                    <div class="district-image" style="background-image: url('https://images.unsplash.com/photo-1464226184884-fa280b87c399?ixlib=rb-4.0.3');">
                        <div class="district-overlay">
                            <h3>Naryn City</h3>
                            <p>{% trans "Urban farming & markets" %}</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="district-card">
                    <div class="district-image" style="background-image: url('https://images.unsplash.com/photo-1441974231531-c6227db76b6e?ixlib=rb-4.0.3');">
                        <div class="district-overlay">
                            <h3>At-Bashy</h3>
                            <p>{% trans "Mountain honey & herbs" %}</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="district-card">
                    <div class="district-image" style="background-image: url('https://images.unsplash.com/photo-1500382017468-9049fed747ef?ixlib=rb-4.0.3');">
                        <div class="district-overlay">
                            <h3>Kochkor</h3>
                            <p>{% trans "Dairy & organic produce" %}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Mountain Range Separator -->
<div class="mountain-separator"></div>

<!-- Featured Categories -->
<section class="categories-section py-5 bg-light">
    <div class="container">
        <div class="section-header text-center mb-5">
            <h2>{% trans "Featured Categories" %}</h2>
            <p class="lead">{% trans "Explore the best of Naryn's agricultural offerings" %}</p>
        </div>
        
        <div class="row g-4">
            {% for category in categories %}
            <div class="col-6 col-md-3 stagger-item">
                <div class="category-card">
                    <div class="category-icon">
                        {% if category.name == "Vegetables" %}
                        <i class="bi bi-flower1"></i>
                        {% elif category.name == "Fruits" %}
                        <i class="bi bi-apple"></i>
                        {% elif category.name == "Dairy" %}
                        <i class="bi bi-cup-hot"></i>
                        {% elif category.name == "Grains" %}
                        <i class="bi bi-grid-3x2"></i>
                        {% else %}
                        <i class="bi bi-basket"></i>
                        {% endif %}
                    </div>
                    <h3 class="category-name">
                        {% if category.name == 'Vegetables' %}
                            {% trans "Vegetables" %}
                        {% elif category.name == 'Fruits' %}
                            {% trans "Fruits" %}
                        {% elif category.name == 'Dairy' %}
                            {% trans "Dairy" %}
                        {% elif category.name == 'Grains' %}
                            {% trans "Grains" %}
                        {% else %}
                            {{ category.get_translated_name }}
                        {% endif %}
                    </h3>
                    <a href="{% url 'frontend:products' %}?category={{ category.id }}" class="category-link"></a>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Featured Products -->
<section class="products-section py-5">
    <div class="container">
        <div class="section-header text-center mb-5 yurt-decoration">
            <h2>{% trans "Featured Products from Naryn" %}</h2>
            <p class="lead">{% trans "Discover the finest products from Naryn's farmers" %}</p>
        </div>
        
        <div class="row g-4">
            {% for product in products %}
            <div class="col-md-4 stagger-item">
                <div class="product-card kyrgyz-pattern">
                    <div class="product-image-container">
                        {% if product.image %}
                        <img src="{{ product.image.url }}" class="product-image" alt="{{ product.get_translated_name }}">
                        {% else %}
                        <div class="product-image-placeholder">
                            <i class="bi bi-image"></i>
                        </div>
                        {% endif %}
                        {% if user.is_authenticated and user.is_buyer %}
                        <button onclick="addToCart({{ product.id }})" class="quick-add-btn" title="{% trans 'Add to Cart' %}">
                            <i class="bi bi-plus-circle-fill"></i>
                        </button>
                        {% endif %}
                    </div>
                    <div class="product-info">
                        <h5 class="product-title">
                            {% if product.name == "Apple" or product.name == "apple" %}
                                {% trans "Apple" %}
                            {% elif product.name == "Potato" %}
                                {% trans "Potato" %}
                            {% elif product.name == "Tomato" %}
                                {% trans "Tomato" %}
                            {% elif product.name == "Cabbage" %}
                                {% trans "Cabbage" %}
                            {% else %}
                                {{ product.get_translated_name }}
                            {% endif %}
                        </h5>
                        <p class="product-category">
                            {% if product.category.name == "Vegetables" %}
                                {% trans "Vegetables" %}
                            {% elif product.category.name == "Fruits" %}
                                {% trans "Fruits" %}
                            {% elif product.category.name == "Dairy" %}
                                {% trans "Dairy" %}
                            {% elif product.category.name == "Grains" %}
                                {% trans "Grains" %}
                            {% else %}
                                {{ product.category.get_translated_name }}
                            {% endif %}
                        </p>
                        <p class="product-description">
                            {% if product.description == "Fresh, organic tomatoes" %}
                                {% trans "Fresh, organic tomatoes" %}
                            {% elif product.description == "High-quality potatoes" %}
                                {% trans "High-quality potatoes" %}
                            {% elif product.description == "Large, fresh cabbages" %}
                                {% trans "Large, fresh cabbages" %}
                            {% else %}
                                {{ product.get_translated_description|truncatechars:60 }}
                            {% endif %}
                        </p>
                        <div class="product-footer">
                            <span class="product-price">{{ product.price|floatformat:2 }} сом / 
                                {% if product.unit == "kg" %}
                                    {% trans "kg" %}
                                {% elif product.unit == "piece" %}
                                    {% trans "piece" %}
                                {% else %}
                                    {{ product.unit }}
                                {% endif %}
                            </span>
                            <a href="{% url 'frontend:product_detail' product.id %}" class="btn btn-sm btn-outline-success">{% trans "Details" %}</a>
                        </div>
                    </div>
                </div>
            </div>
            {% empty %}
            <div class="col-12 text-center">
                <p>{% trans "No products available at the moment." %}</p>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- About Naryn Region section -->
<section class="about-naryn py-5 bg-light">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-6 slide-up">
                <h2 class="mb-4 text-success">{% trans "About Naryn Region" %}</h2>
                <p>{% trans "Naryn is the largest province of Kyrgyzstan, located in the heart of the Tian Shan mountains. With an average elevation of over 2,000 meters, Naryn is known for its pristine nature, clean air, and traditional agricultural practices." %}</p>
                
                <div class="naryn-facts mt-4">
                    <div class="naryn-fact">
                        <div class="fact-icon">
                            <i class="bi bi-geo"></i>
                        </div>
                        <div class="fact-text">
                            <h5>{% trans "Pristine Environment" %}</h5>
                            <p>{% trans "High-altitude farming in clean mountain ecosystems" %}</p>
                        </div>
                    </div>
                    
                    <div class="naryn-fact">
                        <div class="fact-icon">
                            <i class="bi bi-people"></i>
                        </div>
                        <div class="fact-text">
                            <h5>{% trans "Rich Traditions" %}</h5>
                            <p>{% trans "Centuries-old farming knowledge passed through generations" %}</p>
                        </div>
                    </div>
                    
                    <div class="naryn-fact">
                        <div class="fact-icon">
                            <i class="bi bi-flower3"></i>
                        </div>
                        <div class="fact-text">
                            <h5>{% trans "Unique Products" %}</h5>
                            <p>{% trans "Exclusive high-altitude honey, dairy, and herbs" %}</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-6 mt-4 mt-lg-0 slide-in-right">
                <div class="naryn-map-container">
                    <h4 class="text-center mb-3">{% trans "Naryn Region" %}</h4>
                    <!-- Embedded Google Map showing Naryn location -->
                    <div class="map-responsive">
                        <iframe 
                            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d378841.3644296889!2d75.72847577936833!3d41.43478920658371!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x38864e59e0c5280d%3A0xc4dd89b4dd581c8d!2sNaryn%2C%20Kyrgyzstan!5e0!3m2!1sen!2sus!4v1704810928374!5m2!1sen!2sus" 
                            width="100%" 
                            height="350" 
                            style="border:0; border-radius: 15px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);" 
                            allowfullscreen="" 
                            loading="lazy" 
                            referrerpolicy="no-referrer-when-downgrade">
                        </iframe>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Farmer section with enhanced graphics -->
<section class="farmer-section py-5">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-6">
                <h2 class="mb-4 text-success traditional-border">{% trans "Why Join as a Farmer?" %}</h2>
                <div class="d-flex mb-4">
                    <div class="me-3">
                        <span class="bg-success text-white d-inline-flex justify-content-center align-items-center rounded-circle" style="width: 50px; height: 50px; font-size: 1.5rem;">1</span>
                    </div>
                    <div>
                        <h5>{% trans "Direct Sales" %}</h5>
                        <p>{% trans "Sell directly to customers without middlemen and increase your profits." %}</p>
                    </div>
                </div>
                <div class="d-flex mb-4">
                    <div class="me-3">
                        <span class="bg-success text-white d-inline-flex justify-content-center align-items-center rounded-circle" style="width: 50px; height: 50px; font-size: 1.5rem;">2</span>
                    </div>
                    <div>
                        <h5>{% trans "Grow Your Customer Base" %}</h5>
                        <p>{% trans "Reach more customers through our platform." %}</p>
                    </div>
                </div>
                <div class="d-flex mb-4">
                    <div class="me-3">
                        <span class="bg-success text-white d-inline-flex justify-content-center align-items-center rounded-circle" style="width: 50px; height: 50px; font-size: 1.5rem;">3</span>
                    </div>
                    <div>
                        <h5>{% trans "Preserve Naryn Traditions" %}</h5>
                        <p>{% trans "Share your traditional farming practices with a wider audience." %}</p>
                    </div>
                </div>
                <a href="{% url 'frontend:register' %}?user_type=FARMER" class="btn btn-success btn-lg mt-2">{% trans "Register as Farmer" %}</a>
            </div>
            <div class="col-lg-6 mt-4 mt-lg-0">
                <div class="naryn-farmers-illustration snow-cap">
                    <!-- Using a proper mountain image -->
                    <img src="https://images.unsplash.com/photo-1609137144813-7d9921338f24?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80" 
                         alt="Kyrgyz Mountains" 
                         class="img-fluid rounded-3 shadow-lg">
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Naryn Testimonials -->
<section class="testimonials-section py-5">
    <div class="container">
        <div class="section-header text-center">
            <h2>{% trans "Voices from Naryn" %}</h2>
            <p>{% trans "Hear from our farmers and customers" %}</p>
        </div>
        
        <div class="row">
            <div class="col-md-4 mb-4 stagger-item">
                <div class="testimonial-card">
                    <div class="testimonial-icon">
                        <i class="bi bi-quote"></i>
                    </div>
                    <p class="testimonial-text">{% trans "AgroConnect has changed my life as a farmer. Now I can sell directly to customers in Bishkek without leaving my village in At-Bashy." %}</p>
                    <div class="testimonial-author">
                        <div class="author-image">A</div>
                        <div class="author-details">
                            <h5>Askar</h5>
                            <p>{% trans "Honey Farmer, At-Bashy" %}</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-4 mb-4 stagger-item">
                <div class="testimonial-card">
                    <div class="testimonial-icon">
                        <i class="bi bi-quote"></i>
                    </div>
                    <p class="testimonial-text">{% trans "I love the fresh dairy products from Naryn mountains. The kurut and kymyz are the best I've ever tasted!" %}</p>
                    <div class="testimonial-author">
                        <div class="author-image">G</div>
                        <div class="author-details">
                            <h5>Gulnara</h5>
                            <p>{% trans "Customer, Bishkek" %}</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-4 mb-4 stagger-item">
                <div class="testimonial-card">
                    <div class="testimonial-icon">
                        <i class="bi bi-quote"></i>
                    </div>
                    <p class="testimonial-text">{% trans "Thanks to AgroConnect, I'm able to share my traditional farming methods and earn a fair price for my vegetables." %}</p>
                    <div class="testimonial-author">
                        <div class="author-image">M</div>
                        <div class="author-details">
                            <h5>Marat</h5>
                            <p>{% trans "Vegetable Farmer, Naryn" %}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Floating cloud effect -->
<div class="floating-cloud"></div>

<style>
    /* Map responsive iframe wrapper */
    .map-responsive {
        position: relative;
        padding-bottom: 56.25%; /* 16:9 aspect ratio */
        height: 0;
        overflow: hidden;
        max-width: 100%;
    }
    
    .map-responsive iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
    }
    
    @media (max-width: 768px) {
        .map-responsive {
            padding-bottom: 75%; /* Adjust for mobile */
        }
    }
</style>

{% endblock %}

{% block extra_js %}
<script>
    // Create floating particles effect
    document.addEventListener('DOMContentLoaded', function() {
        const particlesContainer = document.getElementById('particles-container');
        
        function createParticle() {
            const particle = document.createElement('div');
            particle.className = 'particle';
            particle.style.left = Math.random() * window.innerWidth + 'px';
            particle.style.animationDuration = (Math.random() * 3 + 4) + 's';
            particle.style.animationDelay = Math.random() * 2 + 's';
            particlesContainer.appendChild(particle);
            
            // Remove particle after animation
            particle.addEventListener('animationend', () => {
                particle.remove();
            });
        }
        
        // Create particles periodically
        setInterval(createParticle, 3000);
        
        // Create initial batch of particles
        for (let i = 0; i < 10; i++) {
            setTimeout(createParticle, i * 200);
        }
        
        // Animation on scroll
        const animatedElements = document.querySelectorAll('.fade-in, .slide-up, .slide-in-right, .stagger-item');
        
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                    observer.unobserve(entry.target);
                }
            });
        }, { threshold: 0.1 });
        
        animatedElements.forEach(element => {
            observer.observe(element);
        });
    });
</script>
{% endblock %}